# Category 0: The Android Framework

## Q) 2. What is the purpose of Pending Intent?

`PendingIntent`는 다른 **애플리케이션**이나 **시스템 컴포넌트**가, 지정된 시점에 앱을 대신해 **미리 정의**된 Intent를 실행할 수 있도록 권한을 부여하는 특별한 형태의 Intent이다.
이는 특히 `알림(notification)`이나 `서비스(service)`와의 상호작용처럼, 앱이 **활성화되어 있지 않을 때**에도 실행되어야 하는 작업에 유용하다.
### Key Features

`PendingIntent`는 일반 Intent를 감싸는 `래퍼(wrapper)`의 역할을 하여 해당 Intent가 앱의 `생명 주기(lifecycle)`를 넘어 유지될 수 있도록 한다.
이 객체는 **다른 앱**이나 **시스템 서비스**가, 원래 앱과 동일한 권한으로 Intent를 실행할 수 있도록 위임하는 역할을 한다.
`PendingIntent`는 `activity`, `service`, `broadcastReceiver`용으로 생성할 수 있다.

`PendingIntent`는 `PendingIntent.getActivity()`, `PendingIntent.getService()`, 또는 `PendingIntent.getBroadcast()`와 같은 **팩토리(Factory)** 메서드를 사용하여 생성할 수 있다.

```kotlin
val intent = Intent(this, MyActivity::class.java)
val pendingIntent = PendingIntent.getActivity(
    this,
    0,
    intent,
    PendingIntent.FLAG_UPDATE_CURRENT
)
val notification = NotificationCompat.Builder(this, CHANNEL_ID)
    .setContentTitle("Title")
    .setContentText("Content")
    .setSmallIcon(R.drawable.ic_notification)
    .setContentIntent(pendingIntent) // 알림을 탭할 때 실행된다 
    .build()
NotificationManagerCompat.from(this).notify(NOTIFICATION_ID, notification)
```

`PendingIntent`는 **자체 동작 방식**이나, **시스템** 및 **다른 컴포넌트**와 상호작용하는 방식을 제어하는 **다양한 플래그**를 지원한다.

- **FLAG_UPDATE_CURRENT:** 기존 `PendingIntent`를 새로운 데이터로 **업데이트**한다.
- **FLAG_CANCEL_CURRENT:** 새로운 `PendingIntent`를 생성하기 전에 기존의 것을 **취소**한다.
- **FLAG_IMMUTABLE:** `PendingIntent`를 **불변하게(immutable)** 만들어, 수신 측에서의 **수정을 방지**한다.
- **FLAG_ONE_SHOT:** `PendingIntent`가 **단 한 번**만 사용될 수 있도록 보장한다.

### 사용 사례

1. **알림:** 사용자가 알림을 탭했을 때 **액티비티**를 시작하는 등의 동작을 가능하게 한다.
2. **알람:** `AlarmManager`를 사용하여 스케쥴링 데 사용된다.
3. **서비스:** **백그라운드 작업**을 `ForegroundService`나 `BroadcastReceiver`에 위임하는 데 사용된다.

### 보안 고려사항

**악의적인 앱**이 내부에 있는 Intent를 수정하는 것을 방지하기 위해 `PendingIntent`에는 항상 `FLAG_IMMUTABLE` 플래그를 설정해야 한다.
이는 특정 시나리오에서 `FLAG_IMMUTABLE` 사용이 필수가 된 **Android 12(API 레벨 31)** 부터 특히 중요하다.

### 실전 질문

**Q)** `PendingIntent`란 무엇이며, 일반 Intent와 어떻게 다른가요? `PendingIntent`를 반드시 사용해야 하는 시나리오의 예를 들어주세요.

**A)** `PendingIntent`는 일반 Intent를 감싸는 특수한 **래퍼**로, Intent의 실행을 **즉시** 하지 않고, 이후에 **다른 앱**이 대신 실행하도록 **위임**하는 기능을 한다.  
해당 위임은 **앱이 종료된 상태**에서도 유효하며, 실행될 때는 원래 앱의 권한을 그대로 사용한다.  
이러한 특징을 가진 `PendingIntent`는 '알림'과 같은 시나리오에서 자주 사용된다. 앱이 알림을 생성한 후 종료되어도, 사용자가 알림을 탭하면 Android 시스템이 `PendingIntent`를 사용해 원래 앱의 화면을 다시 열어줄 수 있다.
